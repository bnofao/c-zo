---
github_number: 21
title: "As a module developer, I want a generic repository"
status: synced
type: feature
priority: high
epic: 20
prd: kit
assignees: []
labels: [type:feature, priority:high, module:kit]
created: 2026-02-04
updated: 2026-02-04
---

## Context
From PRD: kit
Feature: Repository Générique Fonctionnel
Priority: P0 (Must-Have)

## Description
Système de **builders composables** pour éliminer le code CRUD répétitif avec support Drizzle, soft-delete, optimistic locking (version number), et pagination

## User Story
**As a** module developer
**I want to** have a generic repository
**So that** I don't have to write the same CRUD code in every module

## Acceptance Criteria
- [ ] **Builders séparés pour tree-shaking et composition granulaire :**
  - [ ] `createQueries()` : `findById`, `findByIds`, `findOne`, `findMany`, `count`, `exists`
  - [ ] `createCachedQueries()` : queries + cache layer avec invalidation
  - [ ] `createMutations()` : `create`, `createMany`, `update`, `delete`, `restore`, `hardDelete`
  - [ ] `createRepository()` : all-in-one convenience (queries + mutations)
- [ ] Pagination offset + cursor avec `PaginatedResult<T>`
- [ ] Optimistic locking via `version` number (integer)
- [ ] Soft delete via `deletedAt` timestamp
- [ ] Support transactions via `transaction()` method
- [ ] Composition facile pour extensions (spread operator)
- [ ] Import sélectif pour minimiser l'API surface

## Dependencies
Drizzle ORM, @czo/kit/cache (optional)

## Related
- PRD: docs/planning/kit/prd.md
- TRD: docs/planning/kit/trd.md
- Epic: #20
