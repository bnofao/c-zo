---
github_number: 31
title: "Implement CacheManager (useCacheManager)"
status: synced
type: task
priority: high
epic: 20
prd: kit
assignees: []
labels: [priority:high, module:kit, type:task]
created: 2026-02-04
updated: 2026-02-08
---

## Context
From TRD: kit
Section: 3.2 Cache
Parent Feature: #22 (Cache Hybride)

## Technical Requirements

Implement lightweight `CacheManager` for invalidation operations:

```typescript
import { useStorage } from 'nitropack/runtime'

export function useCacheManager(namespace?: string): CacheManager
```

### Interface:
```typescript
export interface CacheManager {
  delete(key: string): Promise<void>
  deleteMany(keys: string[]): Promise<void>
  invalidate(pattern: string): Promise<number>
  has(key: string): Promise<boolean>
  getOrSet<T>(key: string, factory: () => Promise<T>, ttl?: number): Promise<T>
}
```

### Requirements:
- Use Nitro's `useStorage('cache')` internally
- Support namespace prefixing
- Pattern-based invalidation using `storage.getKeys()`
- `getOrSet` as fallback for non-declarative caching

## Acceptance Criteria
- [ ] Implementation matches TRD specification
- [ ] All 5 methods implemented
- [ ] Namespace prefixing works
- [ ] Pattern invalidation works with glob
- [ ] Unit tests written
- [ ] Code reviewed

## Related
- TRD: docs/planning/kit/trd.md (Section 3.2)
- Epic: #20
- Parent: #22
